\section{The Q transform} \label{sec:qtransform}
To conduct the multi-resolution analysis motivated in the previous section, data is processed using the Q transform~\cite{Brown:1991}. The Q transform is a modification of the standard short time Fourier transform~\cite{Gabor:1946} in which the analysis window duration varies inversely with frequency such that the time-frequency plane is covered by tiles of constant Q.

The signal time series, $x(t)$, is projected onto a basis of windowed sine waves:
\begin{equation}
  X(\tau, \phi, Q) = \int_{-\infty}^{+\infty}{ x(t) w(t-\tau,\phi,Q) e^{-2i\pi\phi t}dt}.
  \label{eq:qtransform1}
\end{equation}
The transformed coefficient, $X$, measures the average signal amplitude and phase within a time-frequency region centered on time $\tau$ and frequency $\phi$, whose shape and area are determined by the requested quality factor Q and the particular choice of analysis window, $w$. This region is called a \textit{tile}.

To optimize the algorithmic implementation of the Q transform, we use an alternative form of Eq.~\ref{eq:qtransform1}. The Q transform of Eq.~\ref{eq:qtransform1} can be re-formulated in the frequency domain~\cite{Chatterji:2004}:
\begin{equation}
  X(\tau, \phi, Q) = \int_{-\infty}^{+\infty}{ \tilde{x}(f+\phi) \tilde{w}^{*}(f,\phi,Q) e^{+2i\pi f \tau}df},
  \label{eq:qtransform2}
\end{equation}
where tilded variables represent Fourier-transformed variables. When working with discrete data vectors of size $N$\footnote{All data sequences are assumed to be infinite and of period $N$}, Eq.~\ref{eq:qtransform2} becomes:
\begin{equation}
  X(m,l,q) = \frac{1}{N}\sum_{j=0}^{N-1}{\tilde{x}[j+l]\tilde{w}^{*}[j,l,q]e^{+2i\pi mj/N}},
  \label{eq:qtransform3}
\end{equation}
where $m$, $l$ and $q$ index the tiles in the three dimensions of time, frequency and quality factor respectively. By convention, the $1/N$ normalization factor is only applied for inverse discrete Fourier transforms. In Eq.~\ref{eq:qtransform3}, the signal time series is applied a Fourier transform, a shift in frequency, a multiplication by the frequency-domain window and an inverse Fourier transform. This expression is favored when it comes to implement an efficient discrete Q transform, as with the Omicron algorithm. Indeed, the input time series $x(t)$ is only Fourier-transformed once. Moreover, the inverse Fourier transform is only performed for the frequencies and quality factors that we are interested in.

Using a Gaussian window is a natural choice to provide a good time-frequency resolution. However, such a window has an infinite extent which makes it difficult to use in a discrete analysis framework. Instead, the Omicron algorithm implements a bisquare window which has the simple form:
\begin{equation}
  \tilde{w}(f) = 
  \begin{cases}
    A\left(1 - (f/\Delta f)^2 \right)^2 & |f| < \Delta f, \\
    0 & \textrm{otherwise},
  \end{cases}
  \label{eq:bisquare}
\end{equation}
where $A$ is a normalization factor and $\Delta f$ is the half bandwidth of the window. This window is plotted in Fig.~\ref{} and compared to a Gaussian window. There are many advantages in using such a window~\cite{Chatterji:2004}. First, it is null for $|f| > \Delta f$, so that shorter inverse Fourier transforms are computed in Eq.~\ref{eq:qtransform3}. Second, it achieves a time-frequency localization that is only 4.5~\% greater than the minimum possible time-frequency uncertainty associated with the ideal Gaussian window. Third, it offers a limited energy leakage into time-domain side lobes.


